[
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Submit",
  "modified": "2021-02-26 19:28:07.366710",
  "name": "Purchase Receipt Rejected items notification",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Purchase Receipt",
  "script": "rejected_items = []\n\nfor item in doc.items:\n    if item.rejected_qty > 0:\n        item_str = str(item.item_code + ' : ' + item.item_name)\n        rejected_items.append(item_str)\n\nif len(rejected_items) != 0:\n    content = \"\"\"\n            <h1><strong>Purchase Receipt</strong></h1>\n            <h2><span style=\"color: rgb(102, 185, 102);\">Purchase Receipt Details:</span>\n            </h2><table class=\"table table-bordered\"><tbody>\n            <tr><td data-row=\"insert-column-right\"><strong>Purchase Receipt Rejected Items</strong></td>\n            <td data-row=\"insert-column-right\"><strong style=\"color: rgb(107, 36, 178);\">{name}</strong></td>\n            </tr><tr><td data-row=\"insert-row-below\"><strong>Supplier Name</strong></td>\n            <td data-row=\"insert-row-below\"><strong style=\"color: rgb(107, 36, 178);\">{customer_name}</strong></td></tr>\n            <tr><td data-row=\"insert-column-right\"><strong>Date</strong></td>\n            <td data-row=\"insert-column-right\"><strong style=\"color: rgb(107, 36, 178);\">{due_date}</strong></td>\n            </tr><tr><td data-row=\"row-zajk\">\n            <strong>View Document in ERPNext</strong></td><td data-row=\"row-mze0\">\n            <strong style=\"color: rgb(230, 0, 0);\"><a href=\"{link}\" target=\"_blank\" class=\"btn btn-success\">Click to view document</a></strong></td></tr><tr><td data-row=\"row-779i\">\n            <strong>Note</strong></td><td data-row=\"row-779i\">\n            <strong style=\"color: rgb(255, 153, 0);\">This is a system generated email, please don't reply to this message.</strong></td></tr></tbody></table>\n    \"\"\".format(name=doc.name, customer_name=doc.supplier, due_date=frappe.utils.formatdate(doc.get_formatted('posting_date'), \"dd-mm-yyyy\"),\n                link=frappe.utils.get_url_to_form(doc.doctype, doc.name))\n    query = \"\"\"select distinct r.parent from `tabHas Role` r, `tabUser` p where p.name = r.parent and p.enabled = 1 and p.docstatus < 2 and r.role in ('Accounts Manager', 'Purchase Manager', 'HQ') and p.name not in ('Administrator', 'All', 'Guest')\"\"\"\n    email_list = frappe.db.sql_list(query)\n    try:\n        make(content=content, subject=f'Rejected Items in {doc.name}', send_email=True, recipients=email_list)\n    except:\n        frappe.msgprint('Could not send email')\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "modified": "2021-03-01 13:20:32.260171",
  "name": "Blanket Order Remarks On Reject",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Blanket Order",
  "script": "if doc.workflow_state == 'MD Rejected':\n    if doc.remarks is not None:\n        pass\n    else:\n        frappe.throw(\"Please enter the remarks for rejection\")",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 1,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "modified": "2021-03-01 18:43:46.230189",
  "name": "Employee Posting Date validation",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Employee",
  "script": "# import frappe\n# from frappe.utils import datetime\n\n# try:\n#     doc.posting_date = datetime.strptime(doc.posting_date, '%Y-%m-%d').date()\n# except:\n#     pass\nif doc.posting_date < frappe.utils.datetime.date.today():\n    frappe.throw(\"Today's date value cannot be less than the today's date\")",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "modified": "2021-03-01 18:41:49.333793",
  "name": "Quotation Rejection",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Quotation",
  "script": "if doc.workflow_state == 'Rejected':\n    if doc.remarks is not None:\n        pass\n    else:\n        frappe.throw(\"Please enter the remarks for rejection\")",
  "script_type": "DocType Event"
 }
]